document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("car1-brand"),n=document.getElementById("car2-brand"),o=document.getElementById("car3-brand"),a=document.getElementById("car1-model"),r=document.getElementById("car2-model"),t=document.getElementById("car3-model"),l=document.getElementById("compare-btn"),c=document.getElementById("comparison-results");let s={};function d(e,n){const o=e.value;n.innerHTML='<option value="">Select Model</option>',o?s[o]&&s[o].models?(n.disabled=!1,s[o].models.forEach(e=>{const o=document.createElement("option");o.value=e.id,o.textContent=e.name,n.appendChild(o)})):(console.error(`No models found for brand: ${o}`),n.disabled=!0):n.disabled=!0}function i(){const l=m(e,a),s=m(n,r),d=m(o,t);if(!l&&!s&&!d)return void(c.innerHTML='<div class="comparison-placeholder">\n                <p>Please select at least one car to compare</p>\n            </div>');const i=function(e,n,o){const a=[e,n,o].filter(e=>null!==e);if(0===a.length)return'<div class="comparison-placeholder">\n                <p>Please select at least one car to compare</p>\n            </div>';let r='<div class="comparison-table">\n            <div class="comparison-header">';r+='<div class="comparison-cell header-cell">Specifications</div>',a.forEach(e=>{r+=`<div class="comparison-cell header-cell">${e.brandName} ${e.modelName}</div>`}),r+="</div>",r+='<div class="comparison-row">\n            <div class="comparison-cell">Image</div>',a.forEach(e=>{r+=`<div class="comparison-cell"><img src="${e.specs.image}" alt="${e.brandName} ${e.modelName}" class="comparison-image"></div>`}),r+="</div>";function t(e){return["horsepower","torque","cargoCapacity","fuelTank","topSpeed"].includes(e)}function l(e){return["price","mpg","acceleration","weight"].includes(e)}function c(e){if("string"!=typeof e)return null;if(e.toLowerCase().includes("0-60")||e.toLowerCase().includes("0 to 60")){const n=e.match(/\d+(\.\d+)?(?=\s*(?:sec|seconds|s))/i);return n?parseFloat(n[0]):null}const n=e.match(/\d+(\.\d+)?/);return n?parseFloat(n[0]):null}[{key:"engine",label:"Engine"},{key:"horsepower",label:"Horsepower"},{key:"torque",label:"Torque"},{key:"transmission",label:"Transmission"},{key:"mpg",label:"Fuel Economy"},{key:"price",label:"Starting Price"},{key:"acceleration",label:"Acceleration"},{key:"topSpeed",label:"Top Speed"},{key:"dimensions",label:"Dimensions"},{key:"weight",label:"Weight"},{key:"cargoCapacity",label:"Cargo Capacity"},{key:"fuelTank",label:"Fuel Tank"},{key:"driverAssist",label:"Driver Assistance"},{key:"warranty",label:"Warranty"}].forEach(e=>{r+=`<div class="comparison-row">\n                <div class="comparison-cell">${e.label}</div>`;const n=a.map(n=>c(n.specs[e.key])),o=(t(e.key)||l(e.key))&&n.some(e=>null!==e);a.forEach((a,c)=>{const s=a.specs[e.key]||"N/A";let d="";if(o&&null!==n[c]){const o=n[c],a=n.filter((e,n)=>n!==c&&null!==e);a.length>0&&(t(e.key)?d=o>Math.max(...a)?"better-spec":"worse-spec":l(e.key)&&(d=o<Math.min(...a)?"better-spec":"worse-spec"))}r+=`<div class="comparison-cell ${d}">${s}</div>`}),r+="</div>"});const s=document.createElement("style");return s.textContent='\n            .comparison-header {\n                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n                border-bottom: 2px solid #dee2e6;\n                box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n            }\n            .header-cell {\n                padding: 1.25rem;\n                font-weight: 700;\n                font-size: 1.2rem;\n                color: #343a40;\n                text-transform: uppercase;\n                letter-spacing: 1px;\n                transition: all 0.3s ease;\n                text-align: center;\n                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;\n            }\n            .header-cell:not(:first-child) {\n                border-left: 1px solid rgba(222, 226, 230, 0.5);\n            }\n            .header-cell:hover {\n                background-color: rgba(233, 236, 239, 0.5);\n            }\n            .better-spec {\n                background-color: #e6ffe6;\n                color: #006600;\n            }\n            .worse-spec {\n                background-color: #ffe6e6;\n                color: #cc0000;\n            }\n            .comparison-table {\n                box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n                border-radius: 8px;\n                overflow: hidden;\n            }\n            .comparison-cell {\n                padding: 0.75rem 1rem;\n                border: 1px solid #dee2e6;\n            }\n        ',document.head.appendChild(s),r+="</div>",r}(l,s,d);c.innerHTML=i}function m(e,n){const o=e.value,a=n.value;return o&&a&&s[o]&&s[o].specs&&s[o].specs[a]?{brand:o,brandName:e.options[e.selectedIndex].text,model:a,modelName:n.options[n.selectedIndex].text,specs:s[o].specs[a]}:null}fetch("../data/car-data.json").then(e=>{if(!e.ok)throw new Error("Network response was not ok");return e.json()}).then(c=>{s=c,console.log("Car data loaded successfully"),e.addEventListener("change",()=>d(e,a)),n.addEventListener("change",()=>d(n,r)),o.addEventListener("change",()=>d(o,t)),l.addEventListener("click",i)}).catch(e=>{console.error("Error loading car data:",e),c.innerHTML='<div class="error-message">Error loading car data. Please try again later.</div>'})});